# üß† Dia 37 ‚Äî Tipos de Malware e Vetores de Infec√ß√£o

## üéØ Objetivo
Compreender profundamente os **principais tipos de malware**, suas **formas de propaga√ß√£o**, **t√©cnicas de disfarce**, **indicadores de comprometimento (IOCs)** e como **identificar rastros em logs do Windows e em an√°lises de processos**.

---

## 1. Conceitos Fundamentais

**O que √© Malware?**  
Malware (*malicious software*) √© qualquer programa criado com inten√ß√£o maliciosa ‚Äî roubar dados, corromper sistemas, espionar usu√°rios ou causar danos operacionais.

---

## 2. Tipos de Malware

| Tipo | Descri√ß√£o | Exemplo Real | Sintomas Comuns | Vetor de Infec√ß√£o |
| --- | --- | --- | --- | --- |
| **V√≠rus** | Precisa de intera√ß√£o humana para se propagar; infecta arquivos execut√°veis. | ILOVEYOU (2000) | Lentid√£o, travamentos, arquivos duplicados | Anexos de e-mail, pendrives |
| **Worm** | Replica-se automaticamente em redes, sem intera√ß√£o do usu√°rio. | WannaCry (2017) | Criptografa arquivos e se espalha em LANs | Falhas SMB, portas abertas |
| **Trojan** | Disfar√ßado de programa leg√≠timo; abre backdoors. | Zeus Trojan (2007) | Roubo de credenciais, conex√µes an√¥malas | Downloads falsos, phishing |
| **Ransomware** | Criptografa dados e exige pagamento para liberar. | WannaCry, NotPetya | Arquivos inacess√≠veis, mensagens de resgate | Exploits, macros de e-mail |
| **Spyware / Keylogger** | Captura teclas, tela e tr√°fego do usu√°rio. | DarkComet (RAT) | Lentid√£o, atividade de teclado suspeita | Instala√ß√£o silenciosa |
| **Rootkit** | Oculta processos e arquivos do sistema operacional. | Necurs Rootkit | Processos invis√≠veis, AV desativado | Explora√ß√£o de vulnerabilidades |
| **Botnet** | Rede de m√°quinas controladas remotamente. | Mirai (2016) | Consumo anormal de rede, DDoS | Dispositivos IoT inseguros |

---

## 3. Vetores de Infec√ß√£o

**Principais canais de entrada:**
1. **Phishing** ‚Äî e-mails com links ou anexos maliciosos.  
2. **Exploits** ‚Äî vulnerabilidades em servi√ßos (SMB, RDP, etc.).  
3. **Remov√≠veis** ‚Äî pendrives e m√≠dias externas.  
4. **Sites comprometidos** ‚Äî downloads drive-by.  
5. **Engenharia social** ‚Äî falsos t√©cnicos, atualiza√ß√µes falsas.

---

## 4. Pr√°tica SOC ‚Äî Simula√ß√£o de Detec√ß√£o

**Cen√°rio:** antiv√≠rus alerta  
> üö® Arquivo suspeito detectado: `C:\Users\Public\suspeito.exe` ‚Äî poss√≠vel Trojan.

**Tarefas sugeridas:**
1. **Identificar tipo prov√°vel:** verificar se h√° exfiltra√ß√£o, persist√™ncia, comunica√ß√£o C2 ‚Üí hip√≥tese: *Trojan banc√°rio (Zeus-like)*.  
2. **Analisar IOCs:** caminho do arquivo, hashes, IPs/dom√≠nios contatados, altera√ß√µes no registro, processos filhos.  
3. **Verificar logs do Windows:**
   - **Security Log:** Event ID `4688` (cria√ß√£o de processo).  
   - **System Log:** erros ou falhas correlacionadas.  
   - **Application Log:** falhas de DLLs ou aplica√ß√µes.  

---

## 5. PowerShell na Pr√°tica

**Detectar processos suspeitos e comunica√ß√£o:**

```powershell
# Listar processos com alto uso de CPU
Get-Process | Where-Object {$_.CPU -gt 10} | Select-Object Name, Id, CPU

# Listar processos rodando de pastas tempor√°rias
Get-Process | Where-Object {$_.Path -like "*Temp*"} | Select-Object Name, Id, Path

# Ver conex√µes de rede abertas (pode indicar C2)
Get-NetTCPConnection | Where-Object {$_.State -eq "Established"} | Select-Object OwningProcess, LocalAddress, RemoteAddress, RemotePort
Dicas de investiga√ß√£o:

Procure nomes de processo com grafia estranha (ex: svch0st.exe).

Verifique caminhos fora de C:\Windows\System32 ou C:\Program Files.

Analise comunica√ß√£o cont√≠nua com IPs p√∫blicos desconhecidos.

6. Exerc√≠cios Pr√°ticos
Exerc√≠cio 1 ‚Äî Tabela de Malware
Monte uma tabela com 10 malwares reais contendo: Nome, Tipo, Pa√≠s de origem, Ano, Impacto e M√©todo de mitiga√ß√£o (use VirusTotal ou MITRE ATT&CK como refer√™ncia).

Entreg√°vel sugerido: malware_tabela.csv

Exerc√≠cio 2 ‚Äî Simula√ß√£o de Alerta SOC
Escolha um malware da sua tabela (ex.: Stuxnet).

Escreva um alerta fict√≠cio (formato SOC) e descreva quais logs investigar para confirma√ß√£o.

Exemplo de alerta (padr√£o):

less
Copiar c√≥digo
[ALERTA SOC - PRIORIDADE 2]
Detectado comportamento an√¥malo:
Processo: svchost32.exe
A√ß√£o: Comunica√ß√£o com IP 45.77.89.100:8080
Hip√≥tese: Backdoor Trojan (persist√™ncia)
A√ß√£o recomendada: isolamento do host e coleta de artefatos.
Logs a investigar:

Windows Security (4688 ‚Äî processo criado)

Firewall / Proxy logs (conex√µes para o IP indicado)

EDR / AV alerts (indicadores de persist√™ncia)

Sysmon (se dispon√≠vel ‚Äî cria√ß√£o de processo, conex√µes de rede, cria√ß√£o de driver)

Entreg√°vel sugerido: alerta_soc.txt

Exerc√≠cio 3 ‚Äî An√°lise de Persist√™ncia
Use PowerShell:

powershell
Copiar c√≥digo
Get-CimInstance Win32_StartupCommand | Select-Object Name, Command, Location
Verifique se h√° comandos apontando para pastas tempor√°rias ‚Üí poss√≠vel persist√™ncia maliciosa.

Exerc√≠cio 4 ‚Äî Investigando Comunica√ß√£o Externa
powershell
Copiar c√≥digo
Get-NetTCPConnection | Where-Object {($_.RemoteAddress -notlike "192.*") -and ($_.RemoteAddress -notlike "10.*") -and ($_.RemoteAddress -ne "::")} |
Select-Object LocalAddress, LocalPort, RemoteAddress, RemotePort, State
Analise conex√µes para IPs p√∫blicos desconhecidos.

Exerc√≠cio 5 ‚Äî Teste de Rea√ß√£o
Crie um plano de resposta simples para cada tipo de malware da sua tabela (ex.: Trojan, Ransomware, Worm).

Exemplo resumido:

Tipo	Primeira a√ß√£o	Ferramenta usada	Relat√≥rio final
Trojan	Isolar host	EDR / PowerShell	Log de processos e rede
Ransomware	Desconectar da rede	Firewall / Backup	Arquivo restaurado
Worm	Bloquear portas SMB	Firewall / Wireshark	Lista de IPs infectados

7. Ferramentas Recomendadas
Ferramenta	Fun√ß√£o	Observa√ß√£o
VirusTotal	An√°lise de arquivos e hashes	Verifica m√∫ltiplos AVs
Hybrid Analysis	Sandbox de comportamento	Bom para trojans
Autoruns (Sysinternals)	Lista inicializa√ß√µes autom√°ticas	Detecta persist√™ncia
Wireshark	Captura de tr√°fego	Identifica C2 e exfiltra√ß√£o
Process Explorer	An√°lise de processos	Substitui o Gerenciador de Tarefas

8. Entreg√°veis
Arquivo	Descri√ß√£o
dia37_malware.md	Resumo te√≥rico + exerc√≠cios pr√°ticos (este arquivo)
malware_tabela.csv	Tabela com 10 malwares e caracter√≠sticas
alerta_soc.txt	Alerta fict√≠cio SOC + plano de resposta
analise_processos.txt	Sa√≠das e observa√ß√µes dos comandos PowerShell executados

9. Observa√ß√µes Finais
Documente sempre cada passo da investiga√ß√£o (timestamp, comandos, capturas de tela, hashes).

Priorize isolamento e coleta de artefatos antes de a√ß√µes destrutivas.

Integre findings no seu playbook SOC e atualize regras no SIEM/EDR conforme necess√°rio.