import requests

API_KEY = "SUA_API_KEY"

headers = {
    "x-apikey": API_KEY
}

# =========================
# ğŸ” CONSULTA DE IP
# =========================
IP = "8.8.8.8"
ip_url = f"https://www.virustotal.com/api/v3/ip_addresses/{IP}"

ip_response = requests.get(ip_url, headers=headers)

if ip_response.status_code != 200:
    print("Erro ao consultar IP:", ip_response.status_code)
else:
    ip_data = ip_response.json()
    ip_stats = ip_data["data"]["attributes"]["last_analysis_stats"]

    print("ğŸ“Š Resultado da anÃ¡lise do IP:")
    print(ip_stats)

    if ip_stats["malicious"] > 0:
        print("âš ï¸ IP MALICIOSO â€” BLOQUEAR / INVESTIGAR")
    elif ip_stats["suspicious"] > 0:
        print("âš ï¸ IP SUSPEITO â€” MONITORAR")
    else:
        print("âœ… IP LIMPO")

# =========================
# ğŸŒ CONSULTA DE DOMÃNIO
# =========================
DOMAIN = "example.com"
domain_url = f"https://www.virustotal.com/api/v3/domains/{DOMAIN}"

domain_response = requests.get(domain_url, headers=headers)

if domain_response.status_code != 200:
    print("\nErro ao consultar domÃ­nio:", domain_response.status_code)
else:
    domain_data = domain_response.json()
    categories = domain_data["data"]["attributes"].get("categories", {})

    print("\nğŸŒ Categorias do domÃ­nio:")
    for engine, category in categories.items():
        print(f"- {engine}: {category}")

